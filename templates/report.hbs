<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=chrome">
    <title>Reporte Plan de Pruebas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>

<body>
    <div class="container">
        <h1>Reporte de plan de pruebas</h1>
        <h3>Fecha de generación: {{reportDate}}</h3>

        <h2 id="general">Datos de la planificación</h2>

        <table class="table">
            <thead class="table-primary">
                <th>Proyecto</th>
                <th>Plan de prueba</th>
                <th>Versión del proyecto</th>
            </thead>
            <tbody>
                <tr>
                    <td>{{ testPlan.project.title }}</td>
                    <td>{{ testPlan.title }}</td>
                    <td>{{ testPlan.version.title }}</td>
                </tr>
            </tbody>
        </table>
        <h2>Historias de usuario</h2>
        <table class="table">
            <thead class="table-primary">
                <th>Etiqueta</th>
                <th>Nombre</th>
                <th>Descripción</th>
            </thead>
            <tbody>
                {{#each userStories}}
                <tr>
                    <td>{{tag}}</td>
                    <td>{{name}}</td>
                    <td>{{description}}</td>
                </tr>
                {{/each}}
            </tbody>
        </table>
        <h2>Casos de prueba</h2>
        <table class="table">
            <thead class="table-primary">
                <th>Etiqueta</th>
                <th>Nombre</th>
                <th>Descripción</th>
                <th>Suite de prueba</th>
            </thead>
            <tbody>
                {{#each testCases}}
                <tr>
                    <td>{{tag}}</td>
                    <td>{{title}}</td>
                    <td>{{description}}</td>
                    <td>{{testSuite.tag}} {{testSuite.title}}</td>
                </tr>
                {{/each}}
            </tbody>
        </table>
        <h2 id="traceability">Matriz de trazabilidad de requisitos</h2>
        <table class="table">
            <thead class="table-primary">
                <th>HU</th>
                <th>Nombre</th>
                <th>Criterios de aceptación</th>
                <th>Casos de prueba</th>
            </thead>
            <tbody>
                {{#each userStories}}
                <tr>
                    <td rowspan="{{userStoryCriterias.length}}">{{tag}}</td>
                    <td rowspan="{{userStoryCriterias.length}}">{{name}}</td>
                    {{#with userStoryCriterias.[0]}}
                    <td>{{description}}</td>
                    <td>{{testCase.tag}} {{testCase.title}}</td>
                    {{/with}}
                </tr>
                {{#each userStoryCriterias}}
                {{#greaterThan @index 0}}
                <tr>
                    <td>{{description}}</td>
                    <td>{{testCase.tag}} {{testCase.title}}</td>
                </tr>
                {{/greaterThan}}
                {{/each}}
                {{/each}}
            </tbody>
        </table>

        <h2 id="defects">Defectos reportados</h2>
        <table class="table">
            <thead class="table-primary">
                <th>Etiqueta</th>
                <th>Nombre</th>
                <th>Severidad</th>
                <th>Prioridad</th>
                <th>Estado</th>
            </thead>
            <tbody>
                {{#each defects}}
                <tr>
                    <td>{{tag}}</td>
                    <td>{{title}}</td>
                    <td>{{severity.name}}</td>
                    <td>{{priority.name}}</td>
                    <td>{{defectState.name}}</td>
                </tr>
                {{/each}}
                
                <tr>
                    <td>DT-02</td>
                    <td>Error al registrar categoría</td>
                    <td>Normal</td>
                    <td>Media</td>
                    <td>Aceptado</td>
                </tr>
            </tbody>
        </table>
        
        <div class="row">
            <h2 id="results">Resultados</h2>
        </div>
        <!--.row-->
        <div class="row">
            <div class="col-lg-6">
                <h3 id="requirement-coverage">Cobertura de requisitos</h3>
                <p>Total de requisitos: 2</p>
                <p>Total de requisitos cubiertos: 1</p>
                <p>KPI: 50.0%</p>
                <div id="requirement-coverage-chart"></div>
            </div>
            <!--.col-->
            <div class="col-lg-6">
                <h3 id="test-design-coverage">Cobertura de diseño de las pruebas</h3>
                <p>Total de pruebas planificadas: 2</p>
                <p>Total de pruebas asignadas a historias de usuario: 2</p>
                <p>KPI: 100.0%</p>
                <div id="test-design-coverage-chart"></div>
            </div>
            <!--.col-->
        </div>
        <!--.row-->

        <h3 id="test-execution-coverage">Cobertura de ejecución de pruebas</h3>
        <p>Total de pruebas ejecutadas: 4</p>
        <p>Total de pruebas planificadas: 5</p>
        <p>KPI: 80.0%</p>
        <div id="test-execution-coverage-chart"></div>
    </div>
    <!--.container-->


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
</body>
<style>
    table,
    th,
    td {
        border: 1px solid black;
        border-collapse: collapse;
    }

    a {
        color: inherit;
        /* blue colors for links too */
        text-decoration: inherit;
        /* no underline */
    }
</style>
<script>
    var options = {
        series: [50, 50],
        chart: {
            id: 'requirement-coverage',
            width: 380,
            type: 'pie'
        },
        labels: ['Historias cubiertas', 'Historias no cubiertas'],
        responsive: [{
            breakpoint: 480,
            options: {
                chart: {
                    width: 200
                },
                legend: {
                    position: 'bottom'
                }
            }
        }]
    };

    var chart = new ApexCharts(document.querySelector("#requirement-coverage-chart"), options);
    chart.render();

    var options2 = {
        series: [0, 100],
        chart: {
            id: 'test-design-coverage',
            width: 380,
            type: 'pie',
        },
        labels: ['Pruebas sin asociar', 'Pruebas asociadas a casos de prueba'],
        responsive: [{
            breakpoint: 480,
            options: {
                chart: {
                    width: 200
                },
                legend: {
                    position: 'bottom'
                }
            }
        }]
    };

    var chart = new ApexCharts(document.querySelector("#test-design-coverage-chart"), options2);
    chart.render();

    var options3 = {
        series: [20, 80],
        chart: {
            id: 'test-execution-coverage',
            width: 380,
            type: 'pie',
        },
        labels: ['Pruebas no ejecutadas', 'Pruebas ejecutadas'],
        responsive: [{
            breakpoint: 480,
            options: {
                chart: {
                    width: 200
                },
                legend: {
                    position: 'bottom'
                }
            }
        }]
    };

    var chart = new ApexCharts(document.querySelector("#test-execution-coverage-chart"), options3);
    chart.render();

</script>

</html>